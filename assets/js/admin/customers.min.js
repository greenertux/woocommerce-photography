!function(a){a(function(){function b(b){b||(b=a(".wc-photography-collections-select")),b.select2({placeholder:WCPhotographyCustomerParams.search_placeholder,minimumInputLength:2,multiple:!0,ajax:{url:WCPhotographyCustomerParams.ajax_url,dataType:"json",quietMillis:200,data:function(a){return{term:a,action:"wc_photography_search_collections",security:WCPhotographyCustomerParams.search_collections_nonce}},results:function(a){return{results:a}}},initSelection:function(b,c){var d=a.parseJSON(b.attr("data-selected"));return c(d)},formatSelection:function(a){return'<div class="selected-option" data-id="'+a.id+'">'+a.text+"</div>"}})}function c(c){c||(c=a(".wc-photography-collections-select")),c.select2("destroy"),b(c)}b(),a("body").on("click",".photography-add-collection a",function(){return a(this).next(".fields").toggle(),!1}).on("click",".photography-add-collection .button",function(){var b=a(this),d=b.closest(".collection-form-field"),e=a("input.new-collection",d),f=e.val();return""===f?(e.focus(),!1):(e.attr("disabled","disabled"),b.attr("disabled","disabled").next(".message").remove(),b.after(' <i class="loading">'+WCPhotographyCustomerParams.loading+"</i>"),a.ajax({url:WCPhotographyCustomerParams.ajax_url,data:{action:"wc_photography_add_collection",security:WCPhotographyCustomerParams.add_collection_nonce,name:f},type:"POST",dataType:"json",success:function(f){if(e.val(""),e.removeAttr("disabled"),b.removeAttr("disabled").next(".loading").remove(),f.success){var g=a("input.wc-photography-collections-select",d),h=[],i=[];a(".selected-option",d).each(function(b,c){var d=a(c);h.push({id:d.attr("data-id"),text:d.text()}),i.push(d.attr("data-id"))}),h.push(f.data),i.push(f.data.id),g.attr("data-selected",JSON.stringify(h)).val(i.toString()),c(g),a(".fields",d).toggle()}else b.after('<div class="error inline message">'+WCPhotographyCustomerParams.collection_error+"</div>")}}),!1)}).on("select2-selecting",".wc-photography-collections-select",function(b){var c=a(this).prev(".wc-photography-collections-select"),d=[];a(".selected-option",c).each(function(b,c){var e=a(c);d.push({id:e.attr("data-id"),text:e.text()})}),d.push({id:b.choice.id,text:b.choice.text}),a(this).attr("data-selected",JSON.stringify(d))}).on("select2-removed",".wc-photography-collections-select",function(){var b=a(this).prev(".wc-photography-collections-select"),c=[];a(".selected-option",b).each(function(b,d){var e=a(d);c.push({id:e.attr("data-id"),text:e.text()})}),a(this).attr("data-selected",JSON.stringify(c))})})}(jQuery);